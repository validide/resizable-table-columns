!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).validide_resizableTableColumns={})}(this,function(e){"use strict";t.dataPropertyName="validide_rtc_data_object",t.classes={table:"rtc-table",wrapper:"rtc-wrapper",handleContainer:"rtc-handle-container",handle:"rtc-handle",tableResizing:"rtc-table-resizing",columnResizing:"rtc-column-resizing"},t.attributes={dataResizable:"data-rtc-resizable",dataResizableTable:"data-rtc-resizable-table"},t.data={resizable:"rtcResizable",resizableTable:"rtcResizableTable"},t.events={pointerDown:["mousedown","touchstart"],pointerMove:["mousemove","touchmove"],pointerUp:["mouseup","touchend"],windowResize:["resize"],eventResizeStart:"eventResizeStart.rtc",eventResize:"eventResize.rtc",eventResizeStop:"eventResizeStop.rtc"};var f=t;function t(){}var n=function(){this.column=0,this.table=0},i=function(){this.x=null,this.isDoubleClick=!1},l=function(e,t){this.pointer=new i,this.originalWidths=new n,this.newWidths=new n,this.column=e,this.dragHandler=t},a=(s.kebabCaseToCamelCase=function(e){return e.replace(s.kebabCaseRegex,function(e){return e[1].toUpperCase()})},s.parseStringToType=function(e){if(0!=e.length&&!s.onlyWhiteSpace.test(e)){if(s.trueRegex.test(e))return!0;if(s.falseRegex.test(e))return!1;if(s.notEmptyOrWhiteSpace.test(e)){var t=+e;if(!isNaN(t))return t}}return e},s.regexEscapeRegex=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,s.kebabCaseRegex=/(\-\w)/g,s.trueRegex=/^true$/i,s.falseRegex=/^false$/i,s.onlyWhiteSpace=/^\s$/,s.notEmptyOrWhiteSpace=/\S/,s);function s(){}r.getDataAttributesValues=function(e){if(!e)return null;var t={};if(e.dataset)for(var n in e.dataset)e.dataset.hasOwnProperty(n)&&(t[n]=a.parseStringToType(e.dataset[n]||""));else for(var i=0;i<e.attributes.length;i++)/^data\-/.test(e.attributes[i].name)&&(t[a.kebabCaseToCamelCase(e.attributes[i].name.replace("data-",""))]=a.parseStringToType(e.attributes[i].value));return t};var o=r;function r(){}d.prototype.overrideValues=function(e){if(e=void 0===e?null:e)for(var t in e)this.hasOwnProperty(t)&&(this[t]=e[t])},d.prototype.overrideValuesFromElement=function(e){(e=void 0===e?null:e)&&(e=o.getDataAttributesValues(e),this.overrideValues(e))};var h=d;function d(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.resizeFromBody=!0,this.minWidth=40,this.maxWidth=null,this.doubleClickDelay=500,this.maxInitialWidthHint=null,this.store=null,this.overrideValues(e),this.overrideValuesFromElement(t)}b.prototype.init=function(){this.validateMarkup(),this.createHandlerReferences(),this.wrapTable(),this.assignTableHeaders(),this.storeOriginalWidths(),this.setHeaderWidths(),this.createDragHandles(),this.restoreColumnWidths(),this.checkTableWidth(),this.syncHandleWidths(),this.registerWindowResizeHandler()},b.prototype.dispose=function(){this.destroyDragHandles(),this.restoreOriginalWidths(),this.unwrapTable(),this.onPointerDownRef=null,this.onPointerMoveRef=null,this.onPointerUpRef=null,this.table[f.dataPropertyName]=void 0},b.prototype.validateMarkup=function(){for(var e=0,t=0,n=null,i=0;i<this.table.childNodes.length;i++)"THEAD"===(o=this.table.childNodes[i]).nodeName?(e++,n=o):"TBODY"===o.nodeName&&t++;if(null===n||1!==e)throw"Markup validation: thead count.\nResizableTableColumns requires that the table element has one(1) table head element. Current count: ".concat(e);if(1!==t)throw"Markup validation: tbody count.\nResizableTableColumns requires that the table element has one(1) table body element. Current count: ".concat(t);for(var a=0,s=null,i=0;i<n.childNodes.length;i++)"TR"===(o=n.childNodes[i]).nodeName&&(a++,null===s&&(s=o));if(null===s||a<1)throw"Markup validation: thead row count.\nResizableTableColumns requires that the table head element has at least one(1) table row element. Current count: ".concat(a);for(var o,r=0,l=0,i=0;i<s.childNodes.length;i++)"TH"===(o=s.childNodes[i]).nodeName?r++:"TD"===o.nodeName&&l++;if(r<1)throw"Markup validation: thead first row cells count.\nResizableTableColumns requires that the table head's first row element has at least one(1) table header cell element. Current count: ".concat(r);if(0!==l)throw"Markup validation: thead first row invalid.\nResizableTableColumns requires that the table head's first row element has no(0) table cell(TD) elements. Current count: ".concat(l)},b.prototype.wrapTable=function(){var e;this.wrapper||(this.wrapper=this.ownerDocument.createElement("div"),this.wrapper.classList.add(f.classes.wrapper),(e=this.table.parentNode).insertBefore(this.wrapper,this.table),e.removeChild(this.table),this.wrapper.appendChild(this.table),this.table.classList.add(f.classes.table))},b.prototype.unwrapTable=function(){var e;this.table.classList.remove(f.classes.table),this.wrapper&&((e=this.wrapper.parentNode).insertBefore(this.table,this.wrapper),e.removeChild(this.wrapper),this.wrapper=null)},b.prototype.assignTableHeaders=function(){for(var e,t,n=0;n<this.table.childNodes.length;n++)if("THEAD"===(i=this.table.childNodes[n]).nodeName){e=i;break}if(e){for(n=0;n<e.childNodes.length;n++)if("TR"===(i=e.childNodes[n]).nodeName){t=i;break}if(t)for(var i,n=0;n<t.childNodes.length;n++)"TH"===(i=t.childNodes[n]).nodeName&&this.tableHeaders.push(i)}},b.prototype.storeOriginalWidths=function(){var t=this;this.tableHeaders.forEach(function(e){t.originalWidths.push({el:e,detail:e.style.width})}),this.originalWidths.push({el:this.table,detail:this.table.style.width})},b.prototype.restoreOriginalWidths=function(){this.originalWidths.forEach(function(e){e.el.style.width=e.detail})},b.prototype.setHeaderWidths=function(){var n=this;this.tableHeaders.forEach(function(e){var t=e.offsetWidth,t=n.constrainWidth(e,t);"number"==typeof n.options.maxInitialWidthHint&&(t=Math.min(t,n.options.maxInitialWidthHint)),n.updateWidth(e,t,!0,!1)})},b.prototype.constrainWidth=function(e,t){t=Math.max(t,this.options.minWidth||-1/0);return Math.min(t,this.options.maxWidth||1/0)},b.prototype.createDragHandles=function(){var e,i=this;if(null!=this.dragHandlesContainer)throw"Drag handlers already created. Call <destroyDragHandles> if you wish to recreate them";this.dragHandlesContainer=this.ownerDocument.createElement("div"),null!=(e=this.wrapper)&&e.insertBefore(this.dragHandlesContainer,this.table),this.dragHandlesContainer.classList.add(f.classes.handleContainer),this.getResizableHeaders().forEach(function(){var e,t=i.ownerDocument.createElement("div");t.classList.add(f.classes.handle),null!=(e=i.dragHandlesContainer)&&e.appendChild(t)}),f.events.pointerDown.forEach(function(e,t){var n;null!=(n=i.dragHandlesContainer)&&n.addEventListener(e,i.onPointerDownRef,!1)})},b.prototype.destroyDragHandles=function(){var e,i=this;null!==this.dragHandlesContainer&&(f.events.pointerDown.forEach(function(e,t){var n;null!=(n=i.dragHandlesContainer)&&n.removeEventListener(e,i.onPointerDownRef,!1)}),null!=(e=null==(e=this.dragHandlesContainer)?void 0:e.parentElement)&&e.removeChild(this.dragHandlesContainer))},b.prototype.getDragHandlers=function(){var e=null==this.dragHandlesContainer?null:this.dragHandlesContainer.querySelectorAll(".".concat(f.classes.handle));return e?Array.prototype.slice.call(e).filter(function(e){return"DIV"===e.nodeName}):new Array},b.prototype.restoreColumnWidths=function(){var e,n;!this.options.store||0!==(e=b.generateTableId(this.table)).length&&(n=this.options.store.get(e))&&(this.getResizableHeaders().forEach(function(e){var t=n.columns[b.generateColumnId(e)];void 0!==t&&b.setWidth(e,t)}),void 0!==n.table&&b.setWidth(this.table,n.table))},b.prototype.checkTableWidth=function(){var e=this.wrapper.clientWidth,t=e-this.table.offsetWidth;if(!(t<=0)){for(var n,i,a,s=0,o=0,r=[],l=(this.tableHeaders.forEach(function(e,t){e.hasAttribute(f.attributes.dataResizable)&&(e={el:e,detail:e.offsetWidth},r.push(e),s+=e.detail)}),0),h=null;n=r.shift();){var l=t-o,h=n.el,d=Math.floor(n.detail/s*t),d=Math.min(d,l);if(t<=(o+=this.updateWidth(n.el,n.detail+d,!1,!0)-n.detail))break}0<(l=t-o)&&(a=(i=(null==(i=r[0])?void 0:i.el)||h||this.tableHeaders[this.tableHeaders.length-1]).offsetWidth,this.updateWidth(i,a,!0,!0)),b.setWidth(this.table,e)}},b.prototype.syncHandleWidths=function(){var a=this,e=this.table.clientWidth,s=(b.setWidth(this.dragHandlesContainer,e),this.dragHandlesContainer.style.minWidth="".concat(e,"px"),this.getResizableHeaders());this.getDragHandlers().forEach(function(e,t){var n,i=(a.options.resizeFromBody?a.table:a.table.tHead).clientHeight;t<s.length&&(n=(t=s[t]).offsetWidth,n=(n+=b.getOffset(t).left)-b.getOffset(a.dragHandlesContainer).left,e.style.left="".concat(n,"px"),e.style.height="".concat(i,"px"))})},b.prototype.getResizableHeaders=function(){return this.tableHeaders.filter(function(e,t){return e.hasAttribute(f.attributes.dataResizable)})},b.prototype.handlePointerDown=function(e){this.handlePointerUp();var t,n,i,a,s,o,r=e?e.target:null;null==r||"DIV"!==r.nodeName||!r.classList.contains(f.classes.handle)||"number"==typeof e.button&&0!==e.button||(r=r,(i=this.getDragHandlers().indexOf(r))>=(n=this.getResizableHeaders()).length||(o=(t=(new Date).getTime())-this.lastPointerDown<this.options.doubleClickDelay,a={column:i=(n=n[i]).offsetWidth,table:this.table.offsetWidth},(s=new l(n,r)).pointer={x:b.getPointerX(e),isDoubleClick:o},s.originalWidths=a,s.newWidths=a,this.detachHandlers(),this.attachHandlers(),this.table.classList.add(f.classes.tableResizing),this.wrapper.classList.add(f.classes.tableResizing),r.classList.add(f.classes.columnResizing),n.classList.add(f.classes.columnResizing),this.lastPointerDown=t,this.eventData=s,o=new CustomEvent(f.events.eventResizeStart,{detail:{column:n,columnWidth:i,table:this.table,tableWidth:this.table.clientWidth}}),this.table.dispatchEvent(o),e.preventDefault()))},b.prototype.handlePointerMove=function(e){var t;this.eventData&&e&&(0!=(e=(b.getPointerX(e)||0)-(this.eventData.pointer.x||0))&&(t=this.eventData.originalWidths.table+e,e=this.constrainWidth(this.eventData.column,this.eventData.originalWidths.column+e),b.setWidth(this.table,t),b.setWidth(this.eventData.column,e),this.eventData.newWidths={column:e,table:t},e=new CustomEvent(f.events.eventResize,{detail:{column:this.eventData.column,columnWidth:e,table:this.table,tableWidth:t}}),this.table.dispatchEvent(e)))},b.prototype.handlePointerUp=function(){var e;this.detachHandlers(),this.eventData&&(this.eventData.pointer.isDoubleClick&&this.handleDoubleClick(),this.table.classList.remove(f.classes.tableResizing),this.wrapper.classList.remove(f.classes.tableResizing),this.eventData.dragHandler.classList.remove(f.classes.columnResizing),this.eventData.column.classList.remove(f.classes.columnResizing),this.checkTableWidth(),this.syncHandleWidths(),this.refreshWrapperStyle(),this.saveColumnWidths(),e=this.eventData.newWidths||this.eventData.originalWidths,e=new CustomEvent(f.events.eventResizeStop,{detail:{column:this.eventData.column,columnWidth:e.column,table:this.table,tableWidth:e.table}}),this.table.dispatchEvent(e),this.eventData=null)},b.prototype.handleDoubleClick=function(){if(this.eventData&&this.eventData.column){for(var e=this.eventData.column,t=this.tableHeaders.indexOf(e),n=0,i=[],a=(this.tableHeaders.forEach(function(e,t){e.hasAttribute(f.attributes.dataResizable)||i.push(t)}),this.ownerDocument.createElement("span")),s=(a.style.position="absolute",a.style.left="-99999px",a.style.top="-99999px",a.style.visibility="hidden",this.ownerDocument.body.appendChild(a),this.table.querySelectorAll("tr")),o=0;o<s.length;o++)for(var r=s[o].querySelectorAll("td, th"),l=0,h=0;h<r.length;h++){var d,c=r[h],u=1;if(c.hasAttribute("colspan")&&(d=c.getAttribute("colspan")||"1",d=parseInt(d),u=isNaN(d)?1:d),-1===i.indexOf(h)&&1===u&&l===t){n=Math.max(n,b.getTextWidth(c,a));break}l+=u}this.ownerDocument.body.removeChild(a);var p,e=n-e.offsetWidth;0!=e&&(p=this.eventData.originalWidths.table+e,e=this.constrainWidth(this.eventData.column,this.eventData.originalWidths.column+e),b.setWidth(this.table,p),b.setWidth(this.eventData.column,e),this.eventData.newWidths={column:e,table:p},e=new CustomEvent(f.events.eventResize,{detail:{column:this.eventData.column,columnWidth:e,table:this.table,tableWidth:p}}),this.table.dispatchEvent(e),this.checkTableWidth(),this.syncHandleWidths(),this.saveColumnWidths())}},b.prototype.attachHandlers=function(){var n=this;f.events.pointerMove.forEach(function(e,t){n.ownerDocument.addEventListener(e,n.onPointerMoveRef,!1)}),f.events.pointerUp.forEach(function(e,t){n.ownerDocument.addEventListener(e,n.onPointerUpRef,!1)})},b.prototype.detachHandlers=function(){var n=this;f.events.pointerMove.forEach(function(e,t){n.ownerDocument.removeEventListener(e,n.onPointerMoveRef,!1)}),f.events.pointerUp.forEach(function(e,t){n.ownerDocument.removeEventListener(e,n.onPointerUpRef,!1)})},b.prototype.refreshWrapperStyle=function(){var e;null!=this.wrapper&&(e=this.wrapper.style.overflowX,this.wrapper.style.overflowX="hidden",this.wrapper.style.overflowX=e)},b.prototype.saveColumnWidths=function(){var e,t;!this.options.store||0!==(e=b.generateTableId(this.table)).length&&(t={table:this.table.offsetWidth,columns:{}},this.getResizableHeaders().forEach(function(e){t.columns[b.generateColumnId(e)]=e.offsetWidth}),this.options.store.set(e,t))},b.prototype.createHandlerReferences=function(){var t=this;this.onPointerDownRef||(this.onPointerDownRef=b.debounce(function(e){t.handlePointerDown(e)},100,!0)),this.onPointerMoveRef||(this.onPointerMoveRef=b.debounce(function(e){t.handlePointerMove(e)},5,!1)),this.onPointerUpRef||(this.onPointerUpRef=b.debounce(function(e){t.handlePointerUp()},100,!0))},b.prototype.registerWindowResizeHandler=function(){var n=this.ownerDocument.defaultView;b.windowResizeHandlerRef||(b.windowResizeHandlerRef=b.debounce(b.onWindowResize,50,!1),f.events.windowResize.forEach(function(e,t){null!=n&&n.addEventListener(e,b.windowResizeHandlerRef,!1)}))},b.prototype.handleWindowResize=function(){this.checkTableWidth(),this.syncHandleWidths(),this.saveColumnWidths()},b.prototype.updateWidth=function(e,t,n,i){var a=e.offsetWidth,n=n?t:this.constrainWidth(e,t);return b.setWidth(e,n),i||(t=this.table.offsetWidth+(n-a),b.setWidth(this.table,t)),n},b.onWindowResize=function(e){e=e?e.target:null;if(null!=e)for(var t=e.document.querySelectorAll(".".concat(f.classes.table)),n=0;n<t.length;n++){var i=t[n];"object"==typeof i[f.dataPropertyName]&&i[f.dataPropertyName].handleWindowResize()}},b.generateColumnId=function(e){return(e.getAttribute(f.attributes.dataResizable)||"").trim().replace(/\./g,"_")},b.generateTableId=function(e){e=(e.getAttribute(f.attributes.dataResizableTable)||"").trim().replace(/\./g,"_");return e.length?"rtc/".concat(e):e},b.setWidth=function(e,t){var n=t.toFixed(2);e.style.width="".concat(0<t?n:"0","px")},b.getInstanceId=function(){return b.instancesCount++},b.getPointerX=function(e){if(0===e.type.indexOf("touch")){if(e.touches&&e.touches.length)return e.touches[0].pageX;if(e.changedTouches&&e.changedTouches.length)return e.changedTouches[0].pageX}return e.pageX},b.getTextWidth=function(e,t){var n,i,a;return e&&t?(i=(null==(i=e.textContent)?void 0:i.trim().replace(/\s/g,"&nbsp;"))+"&nbsp;",a=null==(n=e.ownerDocument.defaultView)?void 0:n.getComputedStyle(e),["fontFamily","fontSize","fontWeight","padding","border","boxSizing"].forEach(function(e){t.style[e]=a[e]}),t.innerHTML=i,t.offsetWidth):0},b.getOffset=function(e){var t;return e?{top:(t=e.getBoundingClientRect()).top+e.ownerDocument.body.scrollTop,left:t.left+e.ownerDocument.body.scrollLeft}:{top:0,left:0}},b.instancesCount=0,b.windowResizeHandlerRef=null,b.debounce=function(i,a,s){var o=null;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=s&&!o;o&&clearTimeout(o),o=setTimeout(function(){o=null,s||i.apply(void 0,e)},a),n&&i.apply(void 0,e)}};var c=b;function b(e,t){if("object"!=typeof e||null===e||"[object HTMLTableElement]"!==e.toString())throw'Invalid argument: "table".\nResizableTableColumns requires that the table element is a not null HTMLTableElement object!';if(void 0!==e[f.dataPropertyName])throw'Existing "'.concat(f.dataPropertyName,"\" property.\nTable element already has a '").concat(f.dataPropertyName,"' attached object!");this.id=b.getInstanceId(),this.table=e,this.options=new h(t,e),this.wrapper=null,this.ownerDocument=e.ownerDocument,this.tableHeaders=[],this.dragHandlesContainer=null,this.originalWidths=[],this.eventData=null,this.lastPointerDown=0,this.init(),this.table[f.dataPropertyName]=this}e.PointerData=i,e.ResizableConstants=f,e.ResizableEventData=l,e.ResizableOptions=h,e.ResizableTableColumns=c,e.Utilities=a,e.UtilitiesDOM=o,e.WidthsData=n});